(()=>{"use strict";var e,t;window.jQuery,e=jQuery,(t=e.extend({productTypeSelector:"#product-type",ticketTogglerSelector:"input#_ticket",ticketPanels:".show_if_ticket",ticketFieldsSelector:".ticket_fields",productDataMetaBoxSelector:"#woocommerce-product-data",insertFieldSelector:"a.insert",deleteFieldSelector:"a.delete",fieldLabelSelector:".field_label input",fieldTypeSelector:".field_type select",ticketFields:[],labelVariablesInfoSelector:".ticket-label-variables-info",labelVariablesSelector:".ticket-label-variables",ticketLinkVarSelector:".ticket-link-var",ticketIdVarSelector:".ticket-id-var",ticketBarcodeVarSelector:".ticket-barcode-var",ticketTokenVarSelector:".ticket-token-var",ticketPostVarsSelector:".ticket-post-vars"},wcBoxOfficeParams)).init=function(){t.populateTicketFields(),t.bindEvents(),t.setDefaultPrintContentIfEmpty(),t.setDefaultEmailContentIfEmpty(),new URLSearchParams(window.location.search).has("post")||t.setDefaultFieldsIfEmpty()},t.bindEvents=function(){e(t.productTypeSelector).on("change",t.maybeUncheckTicket).trigger("change"),e(t.ticketTogglerSelector).on("change",t.toggleTicketPanels).trigger("change"),e(t.productDataMetaBoxSelector).on("click",t.ticketFieldsSelector+" "+t.insertFieldSelector,t.insertField),e(t.productDataMetaBoxSelector).on("click",t.ticketFieldsSelector+" "+t.deleteFieldSelector,t.deleteField),e(t.productDataMetaBoxSelector).on("change",t.fieldTypeSelector,t.fieldTypeChange),e(t.ticketFieldsSelector).on("change",t.fieldLabelSelector,t.populateTicketFields),e(t.ticketFieldsSelector).on("row:inserted",t.populateTicketFields),e(t.ticketFieldsSelector).on("row:deleted",t.populateTicketFields),e(t.labelVariablesSelector).on("click","a",t.insertLabelToEditor),e(t.ticketLinkVarSelector).on("click","a",t.insertLabelToEditor),e(t.ticketIdVarSelector).on("click","a",t.insertLabelToEditor),e(t.ticketBarcodeVarSelector).on("click","a",t.insertLabelToEditor),e(t.ticketTokenVarSelector).on("click","a",t.insertLabelToEditor),e(t.ticketPostVarsSelector).on("click","a",t.insertLabelToEditor)},t.maybeUncheckTicket=function(i){var l=e(t.ticketTogglerSelector);if(l.length){var c=l.closest("label").attr("class").trim().split(" ").filter((function(e){return e.startsWith("hide_if_")})).map((function(e){return e.substring(8)})),o=e(i.target).val();e.inArray(o,c)>=0&&l.prop("checked",!1).trigger("change")}},t.toggleTicketPanels=function(i){var l=e(i.target).is(":checked");e(t.ticketPanels).toggle(l)},t.insertField=function(i){var l=e(this).data("row");return e(this).closest(t.ticketFieldsSelector).find("tbody").append(l),e(t.ticketFieldsSelector).trigger("row:inserted"),!1},t.deleteField=function(i){return e(this).closest("tr").remove(),e(t.ticketFieldsSelector).trigger("row:deleted"),!1},t.fieldTypeChange=function(t){var i=e(t.target);switch(i.val()){case"select":case"radio":case"checkbox":i.closest("tr").find(".field_options textarea").show(),i.closest("tr").find(".field_options .email-options").hide();break;case"email":i.closest("tr").find(".field_options textarea").hide(),i.closest("tr").find(".field_options .email-options").show();break;default:i.closest("tr").find(".field_options textarea").hide(),i.closest("tr").find(".field_options .email-options").hide()}return!1},t.populateTicketFields=function(){var i=e(t.fieldLabelSelector,t.ticketFieldsSelector);t.ticketFields=[],i.each((function(){t.ticketFields.push(this.value)})),t.updateLabelVariablesInfo()},t.updateLabelVariablesInfo=function(){t.ticketFields.length?(e(t.labelVariablesSelector).html(""),e.each(t.ticketFields,(function(i,l){e(t.labelVariablesSelector).append('<a href="#"><code>{'+l+"}</code></a>")})),e(t.labelVariablesInfoSelector).show()):e(t.labelVariablesInfoSelector).hide()},t.insertLabelToEditor=function(){var t,i=e(this).closest(".woocommerce_options_panel"),l=e(this).text();switch(i.attr("id")){case"ticket_content_data":t=tinyMCE.get("ticket-content-editor");break;case"ticket_email_data":t=tinyMCE.get("ticket-email-editor")}return t.insertContent(l),!1},t.setDefaultFieldsIfEmpty=function(){if(!t.ticketFields.length){var i=["First Name","Last Name","Email"],l=["first_name","last_name","email"];e(t.insertFieldSelector,t.ticketFieldsSelector).trigger("click"),e(t.insertFieldSelector,t.ticketFieldsSelector).trigger("click"),e(t.insertFieldSelector,t.ticketFieldsSelector).trigger("click"),e("tbody tr",t.ticketFieldsSelector).each((function(c){e(t.fieldLabelSelector,this).val(i[c]).trigger("change"),e(t.fieldTypeSelector,this).val(l[c]).trigger("change")}))}},t.setDefaultPrintContentIfEmpty=function(){t._setTinyMCEDefaultContent("ticket-content-editor",t.defaultPrintContent)},t.setDefaultEmailContentIfEmpty=function(){t._setTinyMCEDefaultContent("ticket-email-editor",t.defaultEmailContent)},t._setTinyMCEDefaultContent=function(t,i){var l=e("#"+t);l&&(l.val()||l.val(i))},e(t.init)})();